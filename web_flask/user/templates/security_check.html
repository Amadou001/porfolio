<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- PAGE TITLE HERE -->
	<title>user</title>
	
	<link href="{{ url_for('.static', filename='vendor/jquery-nice-select/css/nice-select.css') }}" rel="stylesheet">
	<link rel="stylesheet" href="{{ url_for('.static', filename='vendor/nouislider/nouislider.min.css') }}" rel="stylesheet">	
	<!-- Style css -->
    <link href="{{ url_for('.static', filename='css/user_style.css') }}" rel="stylesheet">

	
</head>
<body>

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="waviy">
		   <span style="--i:1">L</span>
		   <span style="--i:2">o</span>
		   <span style="--i:3">a</span>
		   <span style="--i:4">d</span>
		   <span style="--i:5">i</span>
		   <span style="--i:6">n</span>
		   <span style="--i:7">g</span>
		   <span style="--i:8">.</span>
		   <span style="--i:9">.</span>
		   <span style="--i:10">.</span>
		</div>
    </div>
    <!--*******************
        Preloader end
    ********************-->

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">

        <!--**********************************
            Nav header start
        ***********************************-->
        <div class="nav-header">
            <a href="{{ url_for('app_views_user.home') }}" class="brand-logo">
				<svg class="logo-abbr" width="53" height="53" viewBox="0 0 53 53">
					<path class="svg-logo-primary-path" d="M48.3418 41.8457H41.0957C36.8148 41.8457 33.332 38.3629 33.332 34.082C33.332 29.8011 36.8148 26.3184 41.0957 26.3184H48.3418V19.2275C48.3418 16.9408 46.4879 15.0869 44.2012 15.0869H4.14062C1.85386 15.0869 0 16.9408 0 19.2275V48.8594C0 51.1462 1.85386 53 4.14062 53H44.2012C46.4879 53 48.3418 51.1462 48.3418 48.8594V41.8457Z" fill="#5BCFC5"/>
					<path class="svg-logo-primary-path" d="M51.4473 29.4238H41.0957C38.5272 29.4238 36.4375 31.5135 36.4375 34.082C36.4375 36.6506 38.5272 38.7402 41.0957 38.7402H51.4473C52.3034 38.7402 53 38.0437 53 37.1875V30.9766C53 30.1204 52.3034 29.4238 51.4473 29.4238ZM41.0957 35.6348C40.2382 35.6348 39.543 34.9396 39.543 34.082C39.543 33.2245 40.2382 32.5293 41.0957 32.5293C41.9532 32.5293 42.6484 33.2245 42.6484 34.082C42.6484 34.9396 41.9532 35.6348 41.0957 35.6348Z" fill="#5BCFC5"/>
				</svg>
                
				<p class="brand-title" width="124px" height="33px"  style="font-size: 18px;">Student Board</p>
            </a>
            <div class="nav-control">
                <div class="hamburger">
                    <span class="line"></span><span class="line"></span><span class="line"></span>
                </div>
            </div>
        </div>
        <!--**********************************
            Nav header end
        ***********************************-->
		
		
		
		<!--**********************************
            Header start
        ***********************************-->
        <div class="header">
            <div class="header-content">
                <nav class="navbar navbar-expand">
                    <div class="collapse navbar-collapse justify-content-between">
                        <div class="header-left">
							<div class="dashboard_bar">
                                Room : {{room_number}}
                            </div>
                        </div>
                        <ul class="navbar-nav header-right">
							<li class="nav-item">
								<div class="input-group search-area">
									<input type="text" class="form-control" placeholder="Seach here . . . .">
									<span class="input-group-text"><a href="javascript:void(0)"><i class="flaticon-381-search-2"></i></a></span>
								</div>
							</li>
                            <li class="nav-item">
								<a href="javascript:void(0);" class="btn btn-primary d-sm-inline-block d-none">{{Student_id}}<i class="fas fa-id-card-alt"></i></a>
							</li>
                        </ul>
                    </div>
				</nav>
			</div>
		</div>
        <!--**********************************
            Header end ti-comment-alt
        ***********************************-->

        <!--**********************************
            Sidebar start
        ***********************************-->
        <div class="dlabnav">
            <div class="dlabnav-scroll">
				<ul class="metismenu" id="menu">
					<li class="dropdown header-profile">
						<a class="nav-link" href="javascript:void(0);" role="button" data-bs-toggle="dropdown">
							<img src="{{ url_for('.static', filename='img/' + profile_path + '.png') }}" width="20" alt=""/>
							<div class="header-info ms-3">
								<span class="font-w600 ">Hi, <b> {{Student_name}}</b></span>
							</div>
						</a>
						
					</li>
                    <li><a href="{{ url_for('app_views_user.home') }}" aria-expanded="false">
							<i class="flaticon-025-dashboard"></i>
							<span class="nav-text">Dashboard</span>
						</a>
                    </li>
                    <li><a href="{{ url_for('app_views_user.user_profile') }}" aria-expanded="false">
						<i class="fas fa-user"></i>
							<span class="nav-text">Profile</span>
						</a>
                    </li>
                    <li><a href="{{ url_for('app_views_user.user_leaves') }}" aria-expanded="false">
							<i class="fas fa-plane"></i>
							<span class="nav-text">Leave application</span>
						</a>
                    </li>
                    <li><a href="inquiry.html" aria-expanded="false">
							<i class="fas fa-question-circle"></i>
							<span class="nav-text">Inquiry</span>
						</a>
                    </li>
                    <li><a href="leaves_history.html" aria-expanded="false">
							<i class="fas fa-history"></i>
							<span class="nav-text">Leave history</span>
						</a>
                    </li>
                </ul>
			</div>
        </div>
        <!--**********************************
            Sidebar end
        ***********************************-->
		
		<!--**********************************
            Content body start
        ***********************************-->
	<div class="content-body">
		<div class="container-fluid">
			<div class="row">
				<div class="col-xl-12">
					<div class="card">
						<div class="card-body p-4 d-flex align-items-start">
							<!-- Profile Update Form -->
							<form id="profileForm" enctype="multipart/form-data" action="{{ url_for('app_views_user.user_profile') }}" method="POST" class="flex-grow-1 d-flex justify-content-between">
								<div>
									<h1 class="card-title mb-4">Profile's Overview</h1>
									<ul class="card-list list-unstyled">
										<li class="d-flex mb-3">
											<span class="bg-blue circle me-2"></span>
											<div class="d-flex w-100 justify-content-between">
												<h4>
													<strong class="me-1">Username</strong>
													<input type="text" name="username" class="form-control" id="studentName" value="{{ username }}" maxlength="128" disabled>
												</h4>
											</div>
										</li>
										<li class="d-flex align-items-center mb-3">
											<span class="bg-success circle me-2"></span>
											<h4>
												<strong class="me-1">School</strong>
												<input type="text" name="new_school" class="form-control" id="studentId" value="{{ school if school else 'N/A' }}" maxlength="100" disabled>
											</h4>
										</li>
										<li class="d-flex align-items-center mb-3">
											<span class="bg-warning circle me-2"></span>
											<h4>
												<strong class="me-1">Email:</strong>
												<input type="email" name="email" class="form-control" id="studentEmail" value="{{ email if email else 'N/A' }}" maxlength="250" disabled>
											</h4>
										</li>

										{% with messages = get_flashed_messages(with_categories=True) %}
										{% if messages %}
											<div class="flash-messages">
												{% for category, message in messages %}
													<div class="alert alert-{{ category }}">
														{{ message }}
													</div>
												{% endfor %}
											</div>
										{% endif %}
										{% endwith %}

										<li class="d-flex align-items-center mb-3">
											<span class="bg-light circle me-2"></span>
											<h4>
												<strong class="me-1">Password</strong>
												<input type="password" name="current_password" class="form-control" id="studentSchool" placeholder="Enter your current password" maxlength="128" disabled>
											</h4>
										</li>
										<li class="d-flex align-items-center mb-3">
											<span class="bg-blue circle me-2"></span>
											<h4>
												<strong class="me-1">New password:</strong>
												<input type="password" name="new_password" class="form-control" id="studentRoomZone" placeholder="Enter your new password" maxlength="128" disabled>
											</h4>
										</li>
									</ul>

									
									<!-- Edit/Save Button -->
									<div class="d-flex justify-content-end mt-4">
										<button id="editSaveBtn" type="button" class="btn btn-primary" onclick="toggleEdit()">Edit Profile</button>
									</div>
								</div>
			
								<!-- Student Picture -->
								<div class="student-picture ms-4">
									<img id="studentImg" src="{{ url_for('.static', filename='img/' + profile_path + '.png') }}" alt="Student Picture" class="img-fluid rounded-circle">
									<div class="overlay">
										<input type="file" id="profilePic" name="profilePic" style="display: none;" onchange="previewImage()">
										<label id="cameraIconLabel" class="camera-icon" for="profilePic"><i class="fas fa-camera"></i></label>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
				
		
			<!-- CSS -->
			 
			<style>
				.student-picture {
					position: relative;
					width: 220px;
					height: 220px;
					border-radius: 50%;
					overflow: hidden;
					margin-left: 20px; /* Ensure proper spacing from the form */
				}
				.student-picture img {
					width: 100%;
					height: 100%;
					object-fit: cover;
				}
				.overlay {
					position: absolute;
					bottom: 10px;
					right: -20px;
					width: 40px;
					height: 40px;
					background: rgba(0, 0, 0, 0.5);
					border-radius: 50%;
					display: flex;
					align-items: center;
					justify-content: center;
					color: white;
					cursor: pointer;
				}
				.camera-icon i {
					font-size: 20px;
				}
				.card-list input {
					width: 100%;
					max-width: 300px;
					margin-left: 10px;
				}
				/* styles.css */
				.flash-messages {
					margin: 20px 0;
				}

				.alert {
					padding: 15px;
					border-radius: 5px;
					margin-bottom: 20px;
				}

				.alert-success {
					background-color: #d4edda;
					color: #08621d;
					border: 1px solid #c3e6cb;
				}

				.alert-danger {
					background-color: #f8d7da;
					color: #59060e;
					border: 1px solid #f5c6cb;
				}

			</style>
		
			<!-- JavaScript -->
			<script>
				function toggleEdit() {
					const inputs = document.querySelectorAll('.card-list input');
					const profilePicInput = document.getElementById('profilePic');
					const editSaveBtn = document.getElementById('editSaveBtn');
					const cameraIconLabel = document.getElementById('cameraIconLabel');

					if (editSaveBtn.textContent === 'Edit Profile') {
						inputs.forEach(input => input.disabled = false);
						profilePicInput.style.display = 'block'; // Show the file input
						cameraIconLabel.style.display = 'block'; // Show the camera icon
						editSaveBtn.textContent = 'Save';
					} else {
						// Ensure file input is included
						profilePicInput.style.display = 'none'; // Hide the file input
						cameraIconLabel.style.display = 'none'; // Hide the camera icon
						document.getElementById('profileForm').submit();
						inputs.forEach(input => input.disabled = true);
						console.log("Antoine LENO")
						editSaveBtn.textContent = 'Edit Profile';
					}
				}

				document.addEventListener("DOMContentLoaded", function() {
				const flashMessages = document.querySelectorAll('.flash-messages .alert');

				flashMessages.forEach(message => {
					setTimeout(() => {
						message.classList.add('fade-out');
						setTimeout(() => {
							message.remove(); // Remove the element after animation
						}, 1000); // Match this with the duration of the fade-out animation
					}, 5000); // Show the message for 5 seconds
				});
				});
		
				function previewImage() {
					const file = document.getElementById('profilePic').files[0];
					const reader = new FileReader();
					reader.onload = function(e) {
						document.getElementById('studentImg').src = e.target.result;
					};
					if (file) {
						reader.readAsDataURL(file);
					}
				}
		
				// Add event listener to label to trigger file input click
				document.getElementById('cameraIconLabel').addEventListener('click', function() {
					document.getElementById('profilePic').click();
				});
			</script>
		</div>
	</div>

		
		
				
				
        <!--**********************************
            Content body end
        ***********************************-->
		
		
		
        <!--**********************************
            Footer start
        ***********************************-->
		
        <!--**********************************
            Footer end
        ***********************************-->

		


	</div>
    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!--**********************************
        Scripts
    ***********************************-->
    <!-- Required vendors -->
	<script src="{{ url_for('.static', filename='vendor/global/global.min.js') }}"></script>
	<script src="{{ url_for('.static', filename='vendor/chart.js/Chart.bundle.min.js') }}"></script>
	<script src="{{ url_for('.static', filename='vendor/jquery-nice-select/js/jquery.nice-select.min.js') }}"></script>
	
	<!-- Apex Chart -->
	<script src="{{ url_for('.static', filename='vendor/apexchart/apexchart.js') }}"></script>
	<script src="{{ url_for('.static', filename='vendor/nouislider/nouislider.min.js') }}"></script>
	<script src="{{ url_for('static', filename='vendor/wnumb/wNumb.js') }}"></script>
	
	<!-- Dashboard 1 -->
	<script src="{{ url_for('.static', filename='js/dashboard/dashboard-1.js') }}"></script>
	<script src="{{ url_for('.static', filename='js/custom.min.js') }}"></script>
	<script src="{{ url_for('.static', filename='js/dlabnav-init.js') }}"></script>
	<script src="{{ url_for('.static', filename='js/demo.js') }}"></script>
	<script src="{{ url_for('.static', filename='js/styleSwitcher.js') }}"></script>
	
	
</body>

</html>